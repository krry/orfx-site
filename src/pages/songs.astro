---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { elementColors } from '../content/config';

const songs = (await getCollection('songs'))
  .filter(song => !song.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout title="Songs â€” orfx" description="Long-form pieces exploring the five elements of relationship.">
  <div class="space-y-12">
    <section class="py-12 space-y-4">
      <h1 class="text-5xl font-bold text-amber-400">Songs</h1>
      <p class="text-xl text-slate-300">
        Long-form explorations of the relational elements: fire (come here), earth (we are here), air (go away), water (we are apart), aether (where are we).
      </p>
    </section>

    {songs.length > 0 ? (
      <section class="space-y-6">
        <div class="grid gap-6">
          {songs.map(song => (
            <article class="w-full border border-slate-800 rounded-lg p-6 hover:border-amber-400/50 transition group break-words">
              <a href={`/songs/${song.slug}`} class="block group-hover:text-amber-400 transition">
                <h3 class="text-2xl font-bold mb-2 text-amber-400 break-words">{song.data.title}</h3>
              </a>
              <p class="text-slate-400 mb-4 break-words">{song.data.description}</p>
              <div class="flex flex-wrap items-center justify-between gap-4 text-sm">
                <time datetime={song.data.date.toISOString()} class="text-slate-300 break-words">
                  {song.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
                </time>
                <div class="flex flex-wrap gap-2 items-center">
                  {song.data.elements && song.data.elements.map(element => (
                    <span 
                      class="px-2 py-1 rounded text-xs font-medium"
                      style={`background-color: ${elementColors[element]}20; color: ${elementColors[element]};`}
                    >
                      {element}
                    </span>
                  ))}
                  {song.data.tags && song.data.tags.map(tag => (
                    <span class="bg-slate-800 px-2 py-1 rounded text-xs text-slate-400 break-words">
                      #{tag}
                    </span>
                  ))}
                </div>
              </div>
            </article>
          ))}
        </div>
      </section>
    ) : (
      <section class="text-center py-12">
        <p class="text-slate-400">No songs yet. The first notes are being written.</p>
      </section>
    )}
  </div>
</Layout>
